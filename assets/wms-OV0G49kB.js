import{ap as m,bg as o,aA as b,aB as M,z as d,ak as P,a_ as F,bh as f}from"./GeoJSON-DII1Qerq.js";import{a as R}from"./uri-BF60_jX7.js";import{getRequestExtent as N}from"./Image-FE7SDcNP.js";import{DECIMALS as E}from"./common-9rOs42pz.js";import"./index-DPmgT0xU.js";import"./utils-B7F_ho2D.js";import"./_commonjsHelpers-CE1G-McA.js";import"./I18N-DlIXJTel.js";import"./BFormRadioGroup.vue_vue_type_script_setup_true_lang-LQBMttYK-DOMeCoku.js";import"./useStateClass-BGbSLWFN-BNuqkYB7.js";import"./ConditionalWrapper.vue_vue_type_script_lang-IX_NpHH--BXnPMu4c.js";import"./tilecoord-CR7vLr2I.js";import"./common-C7eTg1SE.js";import"./resolution-CU8ppKQ3.js";const T="1.3.0",O=[101,101];function A(e,n,r,c,s){s.WIDTH=r[0],s.HEIGHT=r[1];const t=c.getAxisOrientation(),i=m(s.VERSION,"1.3")>=0;s[i?"CRS":"SRS"]=c.getCode();const g=i&&t.startsWith("ne")?[n[1],n[0],n[3],n[2]]:n;return s.BBOX=g.join(","),R(e,s)}function U(e,n,r,c,s,t,i){t=Object.assign({REQUEST:"GetMap"},t);const g=n/r,a=[o(b(e)/g,E),o(M(e)/g,E)];if(r!=1)switch(i){case"geoserver":const u=90*r+.5|0;"FORMAT_OPTIONS"in t?t.FORMAT_OPTIONS+=";dpi:"+u:t.FORMAT_OPTIONS="dpi:"+u;break;case"mapserver":t.MAP_RESOLUTION=90*r;break;case"carmentaserver":case"qgis":t.DPI=90*r;break;default:throw new Error("Unknown `serverType` configured")}return A(s,e,a,c,t)}function I(e,n){return Object.assign({REQUEST:n,SERVICE:"WMS",VERSION:T,FORMAT:"image/png",STYLES:"",TRANSPARENT:"TRUE"},e)}function q(e){const n=e.hidpi===void 0?!0:e.hidpi,r=d(e.projection||"EPSG:3857"),c=e.ratio||1.5,s=e.load||P,t=e.crossOrigin??null;return(i,g,a)=>{i=N(i,g,a,c),a!=1&&(!n||e.serverType===void 0)&&(a=1);const S=U(i,g,a,r,e.url,I(e.params,"GetMap"),e.serverType),u=new Image;return u.crossOrigin=t,s(u,S).then(L=>({image:L,extent:i,pixelRatio:a}))}}function D(e,n,r){if(e.url===void 0)return;const c=d(e.projection||"EPSG:3857"),s=F(n,r,0,O),t={QUERY_LAYERS:e.params.LAYERS,INFO_FORMAT:"application/json"};Object.assign(t,I(e.params,"GetFeatureInfo"),e.params);const i=f((n[0]-s[0])/r,E),g=f((s[3]-n[1])/r,E),a=m(t.VERSION,"1.3")>=0;return t[a?"I":"X"]=i,t[a?"J":"Y"]=g,A(e.url,s,O,c,t)}function H(e,n){if(e.url===void 0)return;const r={SERVICE:"WMS",VERSION:T,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(n!==void 0){const c=d(e.projection||"EPSG:3857").getMetersPerUnit()||1,s=28e-5;r.SCALE=n*c/s}if(Object.assign(r,e.params),e.params!==void 0&&r.LAYER===void 0){const c=r.LAYERS;if(!(!Array.isArray(c)||c.length!==1))return;r.LAYER=c}return R(e.url,r)}export{T as DEFAULT_VERSION,q as createLoader,D as getFeatureInfoUrl,U as getImageSrc,H as getLegendUrl,I as getRequestParams,A as getRequestUrl};
//# sourceMappingURL=wms-OV0G49kB.js.map
