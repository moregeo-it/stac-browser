import{af as Z,a1 as _,a2 as k,b3 as v}from"./GeoJSON-dVJCj0SI.js";import{T as J}from"./TileGrid-DzNPHZK1.js";import K from"./TileImage-CEJVvt16.js";import{CustomTile as Q}from"./Zoomify-CbHn5lFH.js";import"./index-DLQIbJqc.js";import"./utils-B7F_ho2D.js";import"./_commonjsHelpers-CE1G-McA.js";import"./I18N-DlIXJTel.js";import"./BFormRadioGroup.vue_vue_type_script_setup_true_lang-LQBMttYK-CW7mqt87.js";import"./useStateClass-BGbSLWFN-DVCkhww4.js";import"./ConditionalWrapper.vue_vue_type_script_lang-IX_NpHH--D04gVupl.js";import"./TileRange-2Tc-Ry00.js";import"./tilecoord-CR7vLr2I.js";import"./Tile-C6wKdysJ.js";import"./Tile-G7aX-9AV.js";import"./common-D17H8Wti.js";import"./Tile-oJI9PQZQ.js";import"./UrlTile-CFIfXLkZ.js";import"./tileurlfunction-Bbs9UhLX.js";import"./uri-BP_XjvpC.js";import"./TileEventType-CTN_nmJ7.js";const b={VERSION1:"version1",VERSION2:"version2",VERSION3:"version3"};function M(T){return T.toLocaleString("en",{maximumFractionDigits:10})}class xe extends K{constructor(H){const i=H||{};let y=i.url||"";y=y+(y.lastIndexOf("/")===y.length-1||y===""?"":"/");const O=i.version||b.VERSION2,d=i.sizes||[],h=i.size;Z(h!=null&&Array.isArray(h)&&h.length==2&&!isNaN(h[0])&&h[0]>0&&!isNaN(h[1])&&h[1]>0,"Missing or invalid `size`");const n=h[0],c=h[1],e=i.tileSize,j=i.tilePixelRatio||1,F=i.format||"jpg",D=i.quality||(i.version==b.VERSION1?"native":"default");let u=i.resolutions||[];const s=i.supports||[],W=i.extent||[0,-c,n,0],L=d!=null&&Array.isArray(d)&&d.length>0,V=e!==void 0&&(typeof e=="number"&&Number.isInteger(e)&&e>0||Array.isArray(e)&&e.length>0),z=s!=null&&Array.isArray(s)&&(s.includes("regionByPx")||s.includes("regionByPct"))&&(s.includes("sizeByWh")||s.includes("sizeByH")||s.includes("sizeByW")||s.includes("sizeByPct"));let r,o,g;if(u.sort(function(t,l){return l-t}),V||z)if(e!=null&&(typeof e=="number"&&Number.isInteger(e)&&e>0?(r=e,o=e):Array.isArray(e)&&e.length>0&&((e.length==1||e[1]==null&&Number.isInteger(e[0]))&&(r=e[0],o=e[0]),e.length==2&&(Number.isInteger(e[0])&&Number.isInteger(e[1])?(r=e[0],o=e[1]):e[0]==null&&Number.isInteger(e[1])&&(r=e[1],o=e[1])))),(r===void 0||o===void 0)&&(r=v,o=v),u.length==0){g=Math.max(Math.ceil(Math.log(n/r)/Math.LN2),Math.ceil(Math.log(c/o)/Math.LN2));for(let t=g;t>=0;t--)u.push(Math.pow(2,t))}else{const t=Math.max(...u);g=Math.round(Math.log(t)/Math.LN2)}else if(r=n,o=c,u=[],L){d.sort(function(l,I){return l[0]-I[0]}),g=-1;const t=[];for(let l=0;l<d.length;l++){const I=n/d[l][0];if(u.length>0&&u[u.length-1]==I){t.push(l);continue}u.push(I),g++}if(t.length>0)for(let l=0;l<t.length;l++)d.splice(t[l]-l,1)}else u.push(1),d.push([n,c]),g=0;const U=new J({tileSize:[r,o],extent:W,origin:_(W),resolutions:u}),w=function(t,l,I){let x,p;const B=t[0];if(B>g)return;const E=t[1],P=t[2],a=u[B];if(!(E===void 0||P===void 0||a===void 0||E<0||Math.ceil(n/a/r)<=E||P<0||Math.ceil(c/a/o)<=P)){if(z||V){const f=E*r*a,m=P*o*a;let N=r*a,S=o*a,R=r,A=o;if(f+N>n&&(N=n-f),m+S>c&&(S=c-m),f+r*a>n&&(R=Math.floor((n-f+a-1)/a)),m+o*a>c&&(A=Math.floor((c-m+a-1)/a)),f==0&&N==n&&m==0&&S==c)x="full";else if(!z||s.includes("regionByPx"))x=f+","+m+","+N+","+S;else if(s.includes("regionByPct")){const G=M(f/n*100),X=M(m/c*100),Y=M(N/n*100),q=M(S/c*100);x="pct:"+G+","+X+","+Y+","+q}O==b.VERSION3&&(!z||s.includes("sizeByWh"))?p=R+","+A:!z||s.includes("sizeByW")?p=R+",":s.includes("sizeByH")?p=","+A:s.includes("sizeByWh")?p=R+","+A:s.includes("sizeByPct")&&(p="pct:"+M(100/a))}else if(x="full",L){const f=d[B][0],m=d[B][1];O==b.VERSION3?f==n&&m==c?p="max":p=f+","+m:f==n?p="full":p=f+","}else p=O==b.VERSION3?"max":"full";return y+x+"/"+p+"/0/"+D+"."+F}},C=Q.bind(null,k(e||256).map(function(t){return t*j}));super({attributions:i.attributions,attributionsCollapsible:i.attributionsCollapsible,cacheSize:i.cacheSize,crossOrigin:i.crossOrigin,interpolate:i.interpolate,projection:i.projection,reprojectionErrorThreshold:i.reprojectionErrorThreshold,state:i.state,tileClass:C,tileGrid:U,tilePixelRatio:i.tilePixelRatio,tileUrlFunction:w,transition:i.transition}),this.zDirection=i.zDirection}}export{xe as default};
//# sourceMappingURL=IIIF-BcbLaySM.js.map
